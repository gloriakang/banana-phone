library(readr)
install.packages("readr")
install.packages("tidyr")
install.packages('dplyr')
# flu survey analysis
library(readr)
library(tidyr)
library(dplyr)
library(ggplot2)
install.packages('ggplot2')
install.packages('reshape2')
library(ggplot2)
library(reshape2)
data = read.csv("surveydata.csv")
install.packages("stringi")
knitr::opts_chunk$set(
echo = FALSE,
message = FALSE,
warning = FALSE
)
setwd("~/git/banana-phone/work")
library(readr)
library(tidyr)
library(dplyr)
library(ggplot2)
data = read.csv("surveydata.csv")
# START
# subsetting with dplyr: q1.df = select(data, Q1_start:Q1_end)
# renaming columns: names(dat) = c("name1", "name2", "name3")
# q1.df = question subset with renamed columns
# alternatively, summary(q1.df)
data %>%
group_by(Q1) %>%
summarise(count = n())
# prob don't need these anymore
q1.df = select(data, Q1)
q2.df = select(data, Q2)
q3.df = select(data, Q3)
q4.df = select(data, Q4)
q5.df = select(data, Q5)
q6.df = select(data, Q6)
q7.df = select(data, Q7_1:Q7_otherText)
names(q7.df) = c("Bus", "Carpool", "Subway",
"Train", "Taxi", "Airplane",
"Other", "Refused", "Other text")
q8.df = select(data, Q8_1:Q8_otherText)
names(q8.df) = c("Work", "School", "Shopping",
"Visiting people", "Recreation",
"Other", "Refused", "Other text")
q9.df = select(data, Q9)
q10.df = select(data, Q10_1:Q10_otherText)
names(q10.df) = c("Bus", "Carpool", "Subway",
"Train", "Taxi", "Airplane",
"Don't know", "Other", "Refused",
"Other text")
q11.df = select(data, Q11_1:Q11_OtherText)
names(q11.df) = c("Work", "Schools", "Day care",
"Stores", "Restaurants", "Libraries",
"Hospitals", "Doctor's office", "Public transportation",
"Family or friends", "Other", "Other text")
q12.df = select(data, Q12_1:Q12_OtherText)
names(q12.df) = c("Avoid touching my eyes",
"Avoid touching my nose",
"Avoid touching my mouth",
"Wash my hands with soap",
"Use hand sanitizers",
"Clean the surfaces in my home",
"Clean the surfaces at work",
"Eat nutritious food",
"Get adequate rest",
"Get recommended vaccine",
"Take preventive medicine",
"Cover my nose and mouth with a surgical mask",
"Avoid contact with people who are sick",
"Avoid crowded places",
"Other",
"Other text")
q13.df = select(data, Q13)
q14.df = select(data, Q14)
q15.df = select(data, Q15)
q16.df = select(data, Q16)
q17.df = select(data, Q17)
q18.df = select(data, Q18_1:Q18_otherText)
names(q18.df) = c("The vaccine costs too much",
"The vaccine is not very effective in preventing influenza",
"I am not likely to get influenza",
"Do not know where to get vaccine",
"The side effect of the vaccine are too risky",
"I am allergic to some of the ingredients in the vaccine",
"I do not like shots",
"I just don't get around to doing it",
"I have to travel too far to get vaccine",
"Other",
"Refused",
"Other text")
q19.df = select(data, Q19)
q20.df = select(data, Q20)
q21.df = select(data, Q21)
q22.df = select(data, Q22_1:Q22_OtherText)
names(q22.df) = c("Go to a doctor's office or medical clinic",
"Decide on treatment without consulting a health practitioner",
"Search the internet for a treatment",
"Get adequate sleep",
"Eat nutritious food",
"Take-over-counter medication for symptoms",
"Take an antiviral medicine",
"Take no action to treat the illness",
"Other",
"Other text")
q23.df = select(data, Q23_1:Q23_OtherText)
names(q23.df) = c("Stand away from people",
"Avoid public places",
"Avoid public transportation",
"Stay at home",
"Wash my hands with soap more often",
"Use hand sanitizers",
"Clean the surfaces in my home",
"Clean the surfaces I use at work",
"Cover my nose and mouth with a surgical mask",
"Cover my nose and mouth when I sneeze or cough",
"Other",
"Other text")
q24.df = select(data, Q24_1:Q24_otherText)
names(q24.df) = c("Print media such as newspapers and magazines",
"Traditional media such as television and radio",
"Social media such as internet and blogs",
"Word of mouth",
"None",
"Other",
"Refused",
"Other text")
q25.df = select(data, Q25_1:Q25_OtherText)
names(q25.df) = c("Stand away from people",
"Avoid public places",
"Avoid public transportation",
"Stay at home",
"Wash my hands with soap more often",
"Use hand sanitizers",
"Clean the surfaces in my home",
"Clean the surfaces I use at work",
"Cover my nose and mouth with a surgical mask",
"Cover my nose and mouth when I sneeze or cough",
"Other",
"Other text")
q26.df = select(data, Q26)
q27.df = select(data, Q27_1:Q27_OtherText)
names(q27.df) = c("Keep the child away from the others in the residence",
"Keep the child out of school/daycare",
"Stop child's social activities like play dates",
"Other",
"Other text")
q28.df = select(data, Q28)
q29.df = select(data, Q29_1:Q29_OtherText)
names(q29.df) = c("A parent brings the child to work",
"A parent stays home",
"Another adult stays home",
"Send the child to school sick",
"Take the child to a relative or friends",
"Other",
"Other text")
q30.df = select(data, Q30_1:Q30_OtherText)
names(q30.df) = c("I bring the child to work",
"I stay home",
"Another adult stays home",
"Send the child to school sick",
"Take the child to a relative or friends",
"Other",
"Other text")
q31.df = select(data, Q31:Q31_Codes)
q32.df = select(data, Q32:Q32_Codes)
q33.df = select(data, Q33:Q33_Codes)
# all household questions
hh.df = select(data, PRG_Q34_01:Q50)
# HHM1 first household member
hhm1.df = select(data, Q35:Q42)
q35.df = select(data, Q35)
q36.df = select(data, Q36:Q36_Codes)
q37.df = select(data, Q37:Q37_Codes)
q38.df = select(data, Q38:Q38_Codes)
q39.df = select(data, Q39)
q40.df = select(data, Q40)
q41.df = select(data, Q41)
q42.df = select(data, Q42)
# HHM2 second household member
hhm2.df = select(data, Q43:Q50)
q43.df = select(data, Q43)
q44.df = select(data, Q44:Q44_Codes)
q45.df = select(data, Q45:Q45_Codes)
q46.df = select(data, Q46:Q46_Codes)
q47.df = select(data, Q47)
q48.df = select(data, Q48)
q49.df = select(data, Q49)
q50.df = select(data, Q50)
# gather with tidyr: question frames into columns
# for ggplot and nested questions
# q = gather(q.df, "heading", "values", col:col)
# probably don't need these, do as above
q1 = gather(q1.df, "option", "response", 1)
q2 = gather(q2.df, "option", "response", 1)
q3 = gather(q3.df, "option", "response", 1)
q4 = gather(q4.df, "option", "response", 1)
q5 = gather(q5.df, "option", "response", 1)
q6 = gather(q6.df, "option", "response", 1)
q7 = gather(q7.df, "option", "response", 1:8)
q8 = gather(q8.df, "option", "response", 1:7)
q9 = gather(q9.df, "option", "response", 1)
q10 = gather(q10.df, "option", "response", 1:9)
q11 = gather(q11.df, "option", "response", 1:11)
q12 = gather(q12.df, "option", "response", 1:15)
q13 = gather(q13.df, "option", "response", 1)
q14 = gather(q14.df, "option", "response", 1)
q15 = gather(q15.df, "option", "response", 1)
q16 = gather(q16.df, "option", "response", 1)
q17 = gather(q17.df, "option", "response", 1)
q18 = gather(q18.df, "option", "response", 1:11)
q19 = gather(q19.df, "option", "response", 1)
q20 = gather(q20.df, "option", "response", 1)
q21 = gather(q21.df, "option", "response", 1)
q22 = gather(q22.df, "option", "response", 1:9)
q23 = gather(q23.df, "option", "response", 1:11)
q24 = gather(q24.df, "option", "response", 1:7)
q25 = gather(q25.df, "option", "response", 1:11)
q26 = gather(q1.df, "option", "response", 1)
q27 = gather(q27.df, "option", "response", 1:4)
q28 = gather(q28.df, "option", "response", 1)
q29 = gather(q29.df, "option", "response", 1:6)
q30 = gather(q30.df, "option", "response", 1:6)
q31 = gather(q31.df, "option", "response", 1)
q32 = gather(q32.df, "option", "response", 1)
q33 = gather(q33.df, "option", "response", 1)
# q34 = gather(q34.df, "option", "response", 1)
q35 = gather(q35.df, "option", "response", 1)
q36 = gather(q36.df, "option", "response", 1)
q37 = gather(q37.df, "option", "response", 1)
q38 = gather(q38.df, "option", "response", 1)
q39 = gather(q39.df, "option", "response", 1)
q40 = gather(q40.df, "option", "response", 1)
q41 = gather(q41.df, "option", "response", 1)
q42 = gather(q42.df, "option", "response", 1)
q43 = gather(q43.df, "option", "response", 1)
q44 = gather(q44.df, "option", "response", 1)
q45 = gather(q45.df, "option", "response", 1)
q46 = gather(q46.df, "option", "response", 1)
q47 = gather(q47.df, "option", "response", 1)
q48 = gather(q48.df, "option", "response", 1)
q49 = gather(q49.df, "option", "response", 1)
q50 = gather(q50.df, "option", "response", 1)
# Q1 and Q13: knowing influenza is different from stomach flu; vs. getting the flu vaccine
with(data, table(Q1, Q13))
summary(with(data, table(Q1, Q13)))
# Q1 and Q2: knowing flu and getting flu
with(data, table(Q1, Q2))
summary(with(data, table(Q1, Q2)))
summary(q1.df)
ggplot(q1) + geom_bar(aes(x=response, fill=response))
# alternatively, summary(q1.df)
data %>%
group_by(Q1) %>%
summarise(count = n())
# by gender
q1.gen = data %>%
group_by(Q1, PPGENDER)
q1.gen %>%
summarise(count = n())
ggplot(q1.gen) + geom_bar(aes(x = Q1, fill = PPGENDER), position = "dodge")
