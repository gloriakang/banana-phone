---
title: "Flu Survey Data"
output:
  html_document:
    fig_caption: yes
    fig_height: 3
    theme: cosmo
    toc: yes
  pdf_document:
    fig_caption: yes
    fig_height: 3
    fig_width: 5
    toc: yes
---

```{r setup, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
setwd("~/git/banana-phone/work")
library(readr)
library(tidyr)
library(dplyr)
library(ggplot2)

data = read.csv("surveydata.csv", na = "#NULL!")
```


```{r, eval=FALSE, include=FALSE}
######## working demographic summary ########

# PPINCIMP
income <- data %>%
  select(PPINCIMP) %>%
  gather("variable", "response", 1)


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
# START
# subsetting with dplyr: q1.df = select(data, Q1_start:Q1_end)
# renaming columns: names(dat) = c("name1", "name2", "name3")
# q1.df = question subset with renamed columns

# alternatively, summary(q1.df)
data %>%
  group_by(Q1) %>%
  summarise(count = n())

# prob don't need these anymore
q1.df = select(data, Q1)
q2.df = select(data, Q2)
q3.df = select(data, Q3)
q4.df = select(data, Q4)
q5.df = select(data, Q5)
q6.df = select(data, Q6)

q7.df = select(data, Q7_1:Q7_otherText)
names(q7.df) = c("Bus", "Carpool", "Subway",
                 "Train", "Taxi", "Airplane",
                 "Other", "Refused", "Other text")
q8.df = select(data, Q8_1:Q8_otherText)
names(q8.df) = c("Work", "School", "Shopping",
                 "Visiting people", "Recreation",
                 "Other", "Refused", "Other text")

q9.df = select(data, Q9)

q10.df = select(data, Q10_1:Q10_otherText)
names(q10.df) = c("Bus", "Carpool", "Subway",
                  "Train", "Taxi", "Airplane",
                  "Don't know", "Other", "Refused",
                  "Other text")
q11.df = select(data, Q11_1:Q11_OtherText)
names(q11.df) = c("Work", "Schools", "Day care",
                  "Stores", "Restaurants", "Libraries",
                  "Hospitals", "Doctor's office", "Public transportation",
                  "Family or friends", "Other", "Other text")
q12.df = select(data, Q12_1:Q12_OtherText)
names(q12.df) = c("Avoid touching my eyes",
                  "Avoid touching my nose",
                  "Avoid touching my mouth",
                  "Wash my hands with soap",
                  "Use hand sanitizers",
                  "Clean the surfaces in my home",
                  "Clean the surfaces at work",
                  "Eat nutritious food",
                  "Get adequate rest",
                  "Get recommended vaccine",
                  "Take preventive medicine",
                  "Cover my nose and mouth with a surgical mask",
                  "Avoid contact with people who are sick",
                  "Avoid crowded places",
                  "Other",
                  "Other text")
q13.df = select(data, Q13)
q14.df = select(data, Q14)
q15.df = select(data, Q15)
q16.df = select(data, Q16)
q17.df = select(data, Q17)
q18.df = select(data, Q18_1:Q18_otherText)
names(q18.df) = c("The vaccine costs too much",
                  "The vaccine is not very effective in preventing influenza",
                  "I am not likely to get influenza",
                  "Do not know where to get vaccine",
                  "The side effect of the vaccine are too risky",
                  "I am allergic to some of the ingredients in the vaccine",
                  "I do not like shots",
                  "I just don't get around to doing it",
                  "I have to travel too far to get vaccine",
                  "Other",
                  "Refused",
                  "Other text")
q19.df = select(data, Q19) 
q20.df = select(data, Q20) 
q21.df = select(data, Q21) 
q22.df = select(data, Q22_1:Q22_OtherText)
names(q22.df) = c("Go to a doctor's office or medical clinic",
                  "Decide on treatment without consulting a health practitioner",
                  "Search the internet for a treatment",
                  "Get adequate sleep",
                  "Eat nutritious food",
                  "Take-over-counter medication for symptoms",
                  "Take an antiviral medicine",
                  "Take no action to treat the illness",
                  "Other",
                  "Other text")

q23.df = select(data, Q23_1:Q23_OtherText)
names(q23.df) = c("Stand away from people",
                  "Avoid public places",
                  "Avoid public transportation",
                  "Stay at home",
                  "Wash my hands with soap more often",
                  "Use hand sanitizers",
                  "Clean the surfaces in my home",
                  "Clean the surfaces I use at work",
                  "Cover my nose and mouth with a surgical mask",
                  "Cover my nose and mouth when I sneeze or cough",
                  "Other",
                  "Other text")

q24.df = select(data, Q24_1:Q24_otherText)
names(q24.df) = c("Print media such as newspapers and magazines",
                  "Traditional media such as television and radio",
                  "Social media such as internet and blogs",
                  "Word of mouth",
                  "None",
                  "Other",
                  "Refused",
                  "Other text")
q25.df = select(data, Q25_1:Q25_OtherText)
names(q25.df) = c("Stand away from people",
                  "Avoid public places",
                  "Avoid public transportation",
                  "Stay at home",
                  "Wash my hands with soap more often",
                  "Use hand sanitizers",
                  "Clean the surfaces in my home",
                  "Clean the surfaces I use at work",
                  "Cover my nose and mouth with a surgical mask",
                  "Cover my nose and mouth when I sneeze or cough",
                  "Other",
                  "Other text")
q26.df = select(data, Q26)
q27.df = select(data, Q27_1:Q27_OtherText)
names(q27.df) = c("Keep the child away from the others in the residence",
                  "Keep the child out of school/daycare",
                  "Stop child's social activities like play dates",
                  "Other",
                  "Other text")
q28.df = select(data, Q28)
q29.df = select(data, Q29_1:Q29_OtherText)
names(q29.df) = c("A parent brings the child to work",
                  "A parent stays home",
                  "Another adult stays home",
                  "Send the child to school sick",
                  "Take the child to a relative or friends",
                  "Other",
                  "Other text")
q30.df = select(data, Q30_1:Q30_OtherText)
names(q30.df) = c("I bring the child to work",
                  "I stay home",
                  "Another adult stays home",
                  "Send the child to school sick",
                  "Take the child to a relative or friends",
                  "Other",
                  "Other text")
q31.df = select(data, Q31:Q31_Codes)
q32.df = select(data, Q32:Q32_Codes)
q33.df = select(data, Q33:Q33_Codes)

# all household questions
hh.df = select(data, PRG_Q34_01:Q50)

# HHM1 first household member
hhm1.df = select(data, Q35:Q42)
q35.df = select(data, Q35)
q36.df = select(data, Q36:Q36_Codes)
q37.df = select(data, Q37:Q37_Codes)
q38.df = select(data, Q38:Q38_Codes)
q39.df = select(data, Q39)
q40.df = select(data, Q40)
q41.df = select(data, Q41)
q42.df = select(data, Q42)

# HHM2 second household member
hhm2.df = select(data, Q43:Q50)
q43.df = select(data, Q43)
q44.df = select(data, Q44:Q44_Codes)
q45.df = select(data, Q45:Q45_Codes)
q46.df = select(data, Q46:Q46_Codes)
q47.df = select(data, Q47)
q48.df = select(data, Q48)
q49.df = select(data, Q49)
q50.df = select(data, Q50)
```

```{r, echo=FALSE, warning=FALSE}
# gather with tidyr: question frames into columns
# for ggplot and nested questions
# q = gather(q.df, "heading", "values", col:col)



# probably don't need these, do as above
q1 = gather(q1.df, "option", "response", 1)
q2 = gather(q2.df, "option", "response", 1)
q3 = gather(q3.df, "option", "response", 1)
q4 = gather(q4.df, "option", "response", 1)
q5 = gather(q5.df, "option", "response", 1)
q6 = gather(q6.df, "option", "response", 1)
q7 = gather(q7.df, "option", "response", 1:8)
q8 = gather(q8.df, "option", "response", 1:7)
q9 = gather(q9.df, "option", "response", 1)
q10 = gather(q10.df, "option", "response", 1:9)
q11 = gather(q11.df, "option", "response", 1:11)
q12 = gather(q12.df, "option", "response", 1:15)
q13 = gather(q13.df, "option", "response", 1)
q14 = gather(q14.df, "option", "response", 1)
q15 = gather(q15.df, "option", "response", 1)
q16 = gather(q16.df, "option", "response", 1)
q17 = gather(q17.df, "option", "response", 1)
q18 = gather(q18.df, "option", "response", 1:11)
q19 = gather(q19.df, "option", "response", 1)
q20 = gather(q20.df, "option", "response", 1)
q21 = gather(q21.df, "option", "response", 1)
q22 = gather(q22.df, "option", "response", 1:9)
q23 = gather(q23.df, "option", "response", 1:11)
q24 = gather(q24.df, "option", "response", 1:7)
q25 = gather(q25.df, "option", "response", 1:11)
q26 = gather(q1.df, "option", "response", 1)
q27 = gather(q27.df, "option", "response", 1:4)
q28 = gather(q28.df, "option", "response", 1)
q29 = gather(q29.df, "option", "response", 1:6)
q30 = gather(q30.df, "option", "response", 1:6)
q31 = gather(q31.df, "option", "response", 1)
q32 = gather(q32.df, "option", "response", 1)
q33 = gather(q33.df, "option", "response", 1)
# q34 = gather(q34.df, "option", "response", 1)
q35 = gather(q35.df, "option", "response", 1)
q36 = gather(q36.df, "option", "response", 1)
q37 = gather(q37.df, "option", "response", 1)
q38 = gather(q38.df, "option", "response", 1)
q39 = gather(q39.df, "option", "response", 1)
q40 = gather(q40.df, "option", "response", 1)
q41 = gather(q41.df, "option", "response", 1)
q42 = gather(q42.df, "option", "response", 1)
q43 = gather(q43.df, "option", "response", 1)
q44 = gather(q44.df, "option", "response", 1)
q45 = gather(q45.df, "option", "response", 1)
q46 = gather(q46.df, "option", "response", 1)
q47 = gather(q47.df, "option", "response", 1)
q48 = gather(q48.df, "option", "response", 1)
q49 = gather(q49.df, "option", "response", 1)
q50 = gather(q50.df, "option", "response", 1)
```




# Working analysis

```{r, echo=TRUE, message=FALSE, warning=FALSE}
# Q1 and Q13: knowing influenza is different from stomach flu; vs. getting the flu vaccine
with(data, table(Q1, Q13))
summary(with(data, table(Q1, Q13)))


# Q1 and Q2: knowing flu and getting flu
with(data, table(Q1, Q2))
summary(with(data, table(Q1, Q2)))

```



# Survey questions

### Q1. Before receiving this survey, did you know influenza is different from the stomach flu?
```{r, echo=TRUE}
summary(q1.df)
ggplot(q1) + geom_bar(aes(x=response, fill=response))

# alternatively, summary(q1.df)
data %>%
  group_by(Q1) %>%
  summarise(count = n())


# by gender
q1.gen = data %>%
  group_by(Q1, PPGENDER)
q1.gen %>%
  summarise(count = n())

ggplot(q1.gen) + geom_bar(aes(x = Q1, fill = PPGENDER), position = "dodge")
```


### Q2. Have you had an illness with influenza like symptoms since August 2015?
```{r, echo=TRUE}
summary(q2.df)
ggplot(q2) + geom_bar(aes(x=response, fill=response))

# by gender
q2.gen = data %>%
  group_by(Q2, PPGENDER)
q2.gen %>%
  summarise(count = n())
ggplot(q2.gen) + geom_bar(aes(x = Q2, fill = PPGENDER), position = "dodge")
```


### Q3. Has any other person in your household had an illness with influenza like symptoms since August 2015?
```{r, echo=FALSE}
summary(q3.df)
ggplot(q3) + geom_bar(aes(x=response, fill=response))
```


### Q4. Does your job require you to have a lot of contact with the public?
```{r, echo=FALSE}
summary(q4.df)
ggplot(q4) + geom_bar(aes(x=response, fill=response))
```

### Q5. Do you have a car that you can use to travel to work?
```{r, echo=FALSE}
summary(q5.df)
ggplot(q5) + geom_bar(aes(x=response, fill=response))
```


### Q6. Do you regularly use public transportation?
```{r, echo=FALSE}
summary(q6.df)
ggplot(q6) + geom_bar(aes(x=response, fill=response))
```


### Q7. What types of public transportation do you regularly use? 
```{r, echo=FALSE}
ggplot(q7) + geom_bar(aes(x = response, fill = response), position = "dodge") + facet_wrap(~option)
summary(q7.df)


# Gender:
(q7.gen = data %>%
  select(PPGENDER, Q7_1:Q7_otherText) %>%
  rename("Bus" = Q7_1,
         "Carpool" = Q7_2,
         "Subway" = Q7_3,
         "Train" = Q7_4,
         "Taxi" = Q7_5,
         "Airplane" = Q7_6,
         "Other" = Q7_7,
         "Refused" = Q7_8,
         "Other text" = Q7_otherText) %>%
  gather("option", "response", Bus:Other) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q7.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q7.gen %>%
  summarise(count = n())
```


### Q8. For what types of activities do you regularly use public transportation? 
```{r, echo=FALSE}
ggplot(q8) + geom_bar(aes(x = response, fill = response), position = "dodge") + facet_wrap(~option)
summary(q8.df)


## Gender:
(q.gen = data %>%
  select(PPGENDER, Q8_1:Q8_otherText) %>%
  rename("Work" = Q8_1,
         "School" = Q8_2,
         "Shopping" = Q8_3,
         "Visiting people" = Q8_4,
         "Recreation" = Q8_5,
         "Other" = Q8_6,
         "Refused" = Q8_7,
         "Other text" = Q8_otherText) %>%
  gather("option", "response", Work:Other) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q.gen %>%
  summarise(count = n())

```


#### Q9. Do other members of your household regularly use public transportation?
```{r, echo=FALSE}
summary(q9.df)
ggplot(q9) + geom_bar(aes(x=response, fill=response))
```


#### Q10. What types of public transportation do other members of your household regularly use? 
```{r, echo=FALSE}
ggplot(q10) + geom_bar(aes(x = response, fill = response), position = "dodge") + facet_wrap(~option)
summary(q10.df)

```

### Q11. How do you rate your risk of getting influenza if you visited each of the following locations?
```{r, echo=FALSE}
ggplot(q11) + geom_bar(aes(x = response, fill = response), position = "dodge") + facet_wrap(~option)
summary(q11.df)


# by gender:
(q.gen = data %>%
  select(PPGENDER, Q11_1:Q11_11) %>%
  gather("option", "response", Q11_1:Q11_11) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q.gen %>%
  summarise(count = n())

```

### Q13. Do you get the flu vaccine?
```{r, echo=FALSE}
summary(q13.df)
ggplot(q13) + geom_bar(aes(x=response, fill=response))

# by gender
q13.gen = data %>%
  group_by(Q13, PPGENDER)
q13.gen %>%
  summarise(count = n())
ggplot(q13.gen) + geom_bar(aes(x = Q13, fill = PPGENDER), position = "dodge")

```

#### Q12. Which of the following actions do you take to avoid getting sick? 
```{r, echo=FALSE}
ggplot(q12) + geom_bar(aes(x = response, fill = response), position = "dodge") + facet_wrap(~option)
summary(q12.df)


# by gender:
(q.gen = data %>%
  select(PPGENDER, Q12_1:Q12_15) %>%
  gather("option", "response", Q12_1:Q12_15) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q.gen %>%
  summarise(count = n())

```

#### Q14. How much do you pay to get an influenza vaccine?
```{r, echo=FALSE}
summary(q14.df)
ggplot(q14) + geom_bar(aes(x=response, fill=response))
```

#### Q15. Are you more likely to get a vaccine if others around you get a vaccine?
```{r, echo=FALSE}
summary(q15.df)
ggplot(q15) + geom_bar(aes(x=response, fill=response))

# by gender
q15.gen = data %>%
  group_by(Q15, PPGENDER)
q15.gen %>%
  summarise(count = n())
ggplot(q15.gen) + geom_bar(aes(x = Q15, fill = PPGENDER), position = "dodge")
```

#### Q16. Are you more likely to get a vaccine if others around you do not get a vaccine?
```{r, echo=FALSE}
summary(q16.df)
ggplot(q16) + geom_bar(aes(x=response, fill=response))

# by gender
q16.gen = data %>%
  group_by(Q16, PPGENDER)
q16.gen %>%
  summarise(count = n())
ggplot(q16.gen) + geom_bar(aes(x = Q16, fill = PPGENDER), position = "dodge")
```

#### Q17. Do you get a vaccine to protect yourself, protect others, or protect yourself and others?
```{r, echo=FALSE}
summary(q17.df)
ggplot(q17) + geom_bar(aes(x=response, fill=response))

# by gender
q17.gen = data %>%
  group_by(Q17, PPGENDER)
q17.gen %>%
  summarise(count = n())
ggplot(q17.gen) + geom_bar(aes(x = Q17, fill = PPGENDER), position = "dodge")

```

### Q18. What are the reasons you would not get an influenza vaccine?
```{r, echo=FALSE}
ggplot(q18) + geom_bar(aes(x = response, fill = response), position = "dodge") + facet_wrap(~option)
summary(q18.df)

# by gender:
(q.gen = data %>%
  select(PPGENDER, Q18_1:Q18_11) %>%
  gather("option", "response", Q18_1:Q18_11) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q.gen %>%
  summarise(count = n())

```

### Q19. Do you have health insurance?
```{r, echo=FALSE}
summary(q19.df)
ggplot(q19) + geom_bar(aes(x=response, fill=response))

# by gender
q19.gen = data %>%
  group_by(Q19, PPGENDER)
q19.gen %>%
  summarise(count = n())
ggplot(q19.gen) + geom_bar(aes(x = Q19, fill = PPGENDER), position = "dodge")

```

### Q20. How effective do you think the influenza vaccine is in protecting people from becoming sick with influenza?
```{r, echo=FALSE}
summary(q20.df)
ggplot(q20) + geom_bar(aes(x=response, fill=response))

# by gender
q20.gen = data %>%
  group_by(Q20, PPGENDER)
q20.gen %>%
  summarise(count = n())
ggplot(q20.gen) + geom_bar(aes(x = Q20, fill = PPGENDER), position = "dodge")

```

### Q21. Are influenza vaccines covered by your health insurance?
```{r, echo=FALSE}
summary(q21.df)
ggplot(q21) + geom_bar(aes(x=response, fill=response))

# by gender
q21.gen = data %>%
  group_by(Q21, PPGENDER)
q21.gen %>%
  summarise(count = n())
ggplot(q21.gen) + geom_bar(aes(x = Q21, fill = PPGENDER), position = "dodge")

```

### Q22. Do you do any of the following when you have influenza symptoms?
```{r, echo=FALSE}
ggplot(q22) + geom_bar(aes(x = response, fill = response), position = "dodge") + facet_wrap(~option)
summary(q22.df)

# by gender:
(q.gen = data %>%
  select(PPGENDER, Q22_1:Q22_9) %>%
  gather("option", "response", Q22_1:Q22_9) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q.gen %>%
  summarise(count = n())


```

### Q23. Which of the following actions do you take when you have influenza symptoms to avoid someone else from getting sick?
```{r, echo=FALSE}
ggplot(q23) + geom_bar(aes(x = response, fill = response), position = "dodge") + facet_wrap(~option)
summary(q23.df)


# by gender:
(q.gen = data %>%
  select(PPGENDER, Q23_1:Q23_11) %>%
  gather("option", "response", Q23_1:Q23_11) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q.gen %>%
  summarise(count = n())


```

#### Q24. What sources of information do you recall hearing or seeing about influenza outbreaks? 
```{r, echo=FALSE}
ggplot(q24) + geom_bar(aes(x = response, fill = response), position = "dodge") + facet_wrap(~option)
summary(q24.df)
```

#### Q25. If you received information from the news, internet or other public media that there was an influenza outbreak in your community would you do any of the following?
```{r, echo=FALSE}
summary(q25.df)
ggplot(q25) + geom_bar(aes(x=response, fill=response), position = "dodge") + facet_wrap(~option)
```

#### Q26. Does your household have children?
```{r, echo=FALSE}
summary(q26.df)
ggplot(q26) + geom_bar(aes(x=response, fill=response))
```

### Q27. What actions do you take when a child in your household has influenza symptoms?
```{r, echo=FALSE}
summary(q27.df)
ggplot(q27) + geom_bar(aes(x=response, fill=response), position = "dodge") + facet_wrap(~option)


# by gender:
(q.gen = data %>%
  select(PPGENDER, Q27_1:Q27_4) %>%
  gather("option", "response", Q27_1:Q27_4) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q.gen %>%
  summarise(count = n())
```

#### Q28. Are you a single parent?
```{r, echo=FALSE}
summary(q28.df)
ggplot(q28) + geom_bar(aes(x=response, fill=response))

# by gender
q28.gen = data %>%
  group_by(Q28, PPGENDER)
q28.gen %>%
  summarise(count = n())
ggplot(q28.gen) + geom_bar(aes(x = Q28, fill = PPGENDER), position = "dodge")

```

#### Q29. How do you care for a sick child?
```{r, echo=FALSE}
summary(q29.df)
ggplot(q29) + geom_bar(aes(x=response, fill=response), position = "dodge") + facet_wrap(~option)


# by gender:
(q.gen = data %>%
  select(PPGENDER, Q29_1:Q29_6) %>%
  gather("option", "response", Q29_1:Q29_6) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q.gen %>%
  summarise(count = n())
```

#### Q30. How do you care for a sick child?
```{r, echo=FALSE}
summary(q30.df)
ggplot(q30) + geom_bar(aes(x=response, fill=response), position = "dodge") + facet_wrap(~option)


# by gender:
(q.gen = data %>%
  select(PPGENDER, Q30_1:Q30_6) %>%
  gather("option", "response", Q30_1:Q30_6) %>%
  group_by(PPGENDER, option, response)
)
# bar plot
ggplot(q.gen) + geom_bar(aes(x = response, fill = PPGENDER), position = "dodge") + facet_wrap(~option)

# count
q.gen %>%
  summarise(count = n())

```

#### Q31. How many hours of screen time (time spent watching television, a computer, smartphone, iPad, etc.) do you spend each day on average when you are not sick? Enter 0 if none
```{r, echo=FALSE}
summary(q31.df)
ggplot(q31) + geom_bar(aes(x=response, fill=response))

# by gender
q31.gen = data %>%
  group_by(Q31, PPGENDER)
q31.gen %>%
  summarise(count = n())
ggplot(q31.gen) + geom_bar(aes(x = Q31, fill = PPGENDER), position = "dodge")

```


#### Q32. How many hours of screen time do you spend each day on average when you are sick? Enter 0 if none
```{r, echo=FALSE}
summary(q32.df)
ggplot(q32) + geom_bar(aes(x=response, fill=response))

q32.gen = data %>%
  group_by(Q32, PPGENDER)
q32.gen %>%
  summarise(count = n())
ggplot(q32.gen) + geom_bar(aes(x = Q32, fill = PPGENDER), position = "dodge")

```

#### Q33. How many people, including yourself, reside in your household?
```{r, echo=FALSE}
summary(q33.df)
ggplot(q33) + geom_bar(aes(x=response, fill=response))

q33.gen = data %>%
  group_by(Q33, PPGENDER)
q33.gen %>%
  summarise(count = n())
ggplot(q33.gen) + geom_bar(aes(x = Q33, fill = PPGENDER), position = "dodge")
```


# Household members

```{r, echo=FALSE}
summary(hhm1.df)
summary(hhm2.df)
```

## HHM1
#### Q35. What is the gender of this member of the household?  Remember, this relates to HHM1_Name who is HHM1_AGE years old.
```{r, echo=FALSE}
summary(q35.df)
ggplot(q35) + geom_bar(aes(x=response, fill=response))

```

#### Q36. On average, how many days per week does this member of your household work or attend day care or school outside of your home?
```{r, echo=FALSE}
summary(q36.df)
ggplot(q36) + geom_bar(aes(x=response, fill=response))
```

#### Q37. On average, how many days per week does this member of your household participate in social activities outside of your home?
```{r, echo=FALSE}
summary(q37.df)
ggplot(q37) + geom_bar(aes(x=response, fill=response))
```

#### Q38. On average, how many days per week does this member of your household use public transportation?
```{r, echo=FALSE}
summary(q38.df)
ggplot(q38) + geom_bar(aes(x=response, fill=response))
```

#### Q39. How frequently does this member of your household visit a doctor's office for wellness appointments?
```{r, echo=FALSE}
summary(q39.df)
ggplot(q39) + geom_bar(aes(x=response, fill=response))
```

#### Q40. How frequently does this member of the household get sick in a typical year?
```{r, echo=FALSE}
summary(q40.df)
ggplot(q40) + geom_bar(aes(x=response, fill=response))
```

#### Q41. How many times has this member of your household had influenza or another respiratory illness in the last two years?
```{r, echo=FALSE}
summary(q41.df)
ggplot(q41) + geom_bar(aes(x=response, fill=response))
```

#### Q42. Does this member of your household get an annual influenza vaccine?
```{r, echo=FALSE}
summary(q42.df)
ggplot(q42) + geom_bar(aes(x=response, fill=response))
```


## HHM2
#### Q43. What is the gender of this member of the household?  Remember, this relates to HHM1_Name who is HHM1_AGE years old.
```{r, echo=FALSE}
summary(q43.df)
ggplot(q43) + geom_bar(aes(x=response, fill=response))
```

#### Q44. On average, how many days per week does this member of your household work or attend day care or school outside of your home?
```{r, echo=FALSE}
summary(q44.df)
ggplot(q44) + geom_bar(aes(x=response, fill=response))
```

#### Q45. On average, how many days per week does this member of your household participate in social activities outside of your home?
```{r, echo=FALSE}
summary(q45.df)
ggplot(q45) + geom_bar(aes(x=response, fill=response))
```

#### Q46. On average, how many days per week does this member of your household use public transportation?
```{r, echo=FALSE}
summary(q46.df)
ggplot(q46) + geom_bar(aes(x=response, fill=response))
```

#### Q47. How frequently does this member of your household visit a doctor's office for wellness appointments?
```{r, echo=FALSE}
summary(q47.df)
ggplot(q47) + geom_bar(aes(x=response, fill=response))
```

#### Q48. How frequently does this member of the household get sick in a typical year?
```{r, echo=FALSE}
summary(q48.df)
ggplot(q48) + geom_bar(aes(x=response, fill=response))

```


#### Q49. How many times has this member of your household had influenza or another respiratory illness in the last two years?
```{r, echo=FALSE}
summary(q49.df)
ggplot(q49) + geom_bar(aes(x=response, fill=response))

```


#### Q50. Does this member of your household get an annual influenza vaccine?
```{r, echo=FALSE}
summary(q50.df)
ggplot(q50) + geom_bar(aes(x=response, fill=response))

```








## to-do:
- need to remove NA's
- ggplot(q7) + geom_bar(aes(x = option, fill = response), position = "dodge")
- ggplot(data = data) + geom_bar(mapping = aes(x = Q1)) + stat_sum()

